<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¨ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ø¹Ú©Ø³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ - Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f8fafc;
            --gray: #94a3b8;
            --border: #e2e8f0;
        }
        
        body {
            font-family: 'Vazirmatn', 'Tahoma', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            opacity: 0.2;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .api-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 15px;
            backdrop-filter: blur(10px);
        }
        
        .content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            gap: 30px;
        }
        
        @media (max-width: 992px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
        
        .settings-panel {
            background: var(--light);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--border);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .panel-title {
            font-size: 1.3rem;
            color: var(--primary-dark);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .panel-title i {
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-label i {
            color: var(--primary);
        }
        
        .prompt-input {
            width: 100%;
            padding: 18px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: all 0.3s;
            background: white;
        }
        
        .prompt-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .char-count {
            text-align: left;
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 5px;
        }
        
        .negative-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s;
        }
        
        .negative-input:focus {
            border-color: var(--primary);
        }
        
        .grid-2, .grid-3 {
            display: grid;
            gap: 15px;
        }
        
        .grid-2 {
            grid-template-columns: 1fr 1fr;
        }
        
        .grid-3 {
            grid-template-columns: 1fr 1fr 1fr;
        }
        
        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 0.95rem;
            background: white;
            transition: all 0.3s;
        }
        
        select:focus, input[type="number"]:focus, input[type="text"]:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .api-selector {
            background: white;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid var(--border);
            margin-bottom: 20px;
        }
        
        .api-option {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .api-option:hover {
            background: #f1f5f9;
        }
        
        .api-option.active {
            background: rgba(99, 102, 241, 0.1);
            border: 1px solid var(--primary);
        }
        
        .api-radio {
            display: none;
        }
        
        .api-radio:checked + .api-label {
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        .api-features {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 5px;
            padding-right: 25px;
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }
        
        .result-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--border);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            min-height: 600px;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .result-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #f8fafc;
            border-radius: 12px;
            padding: 30px;
            border: 2px dashed var(--border);
            position: relative;
            overflow: hidden;
        }
        
        .placeholder {
            text-align: center;
            color: var(--gray);
            padding: 30px;
        }
        
        .placeholder i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--primary);
            opacity: 0.5;
        }
        
        .loading {
            text-align: center;
            padding: 30px;
            display: none;
            width: 100%;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-details {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
            width: 100%;
        }
        
        .progress-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            width: 0%;
            transition: width 0.3s;
            border-radius: 4px;
        }
        
        .result-image {
            max-width: 100%;
            max-height: 450px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            width: 100%;
            display: none;
        }
        
        .action-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }
        
        .regenerate-btn {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
            color: white;
        }
        
        .regenerate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.3);
        }
        
        .share-btn {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }
        
        .examples {
            background: #f0f9ff;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            border: 1px solid #bae6fd;
        }
        
        .examples-title {
            font-size: 1.2rem;
            color: #0369a1;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .example-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 15px;
        }
        
        .example-tag {
            background: white;
            padding: 12px 20px;
            border-radius: 25px;
            border: 1px solid #bae6fd;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .example-tag:hover {
            background: #0284c7;
            color: white;
            border-color: #0284c7;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(2, 132, 199, 0.2);
        }
        
        .example-tag i {
            font-size: 0.9rem;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #64748b;
            font-size: 0.9rem;
            border-top: 1px solid var(--border);
            background: var(--light);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .footer-link {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .footer-link:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            background: var(--dark);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            animation: slideIn 0.3s ease-out;
            z-index: 1000;
            display: none;
            max-width: 400px;
            border-right: 5px solid var(--primary);
        }
        
        .notification.success {
            border-right-color: var(--success);
        }
        
        .notification.error {
            border-right-color: var(--danger);
        }
        
        .notification.warning {
            border-right-color: var(--warning);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .notification-close {
            position: absolute;
            top: 10px;
            left: 15px;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .image-info {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid var(--border);
            font-size: 0.9rem;
            display: none;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .info-row:last-child {
            border-bottom: none;
        }
        
        .info-label {
            color: var(--gray);
        }
        
        .info-value {
            font-weight: 500;
        }
        
        .history-section {
            margin-top: 30px;
        }
        
        .history-title {
            font-size: 1.1rem;
            color: var(--dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            max-height: 120px;
            overflow-y: auto;
            padding: 10px;
            background: #f8fafc;
            border-radius: 10px;
        }
        
        .history-item {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            opacity: 0.8;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .history-item:hover {
            opacity: 1;
            transform: scale(1.05);
        }
        
        .history-item.active {
            border-color: var(--primary);
            opacity: 1;
        }
        
        .history-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .empty-history {
            grid-column: 1 / -1;
            text-align: center;
            padding: 20px;
            color: var(--gray);
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        .mobile-menu {
            display: none;
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            margin-bottom: 20px;
            width: 100%;
        }
        
        @media (max-width: 768px) {
            .content {
                padding: 20px;
                gap: 20px;
            }
            
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .example-tags {
                justify-content: center;
            }
            
            .mobile-menu {
                display: block;
            }
            
            .settings-panel {
                display: none;
            }
            
            .settings-panel.active {
                display: block;
            }
        }
        
        /* Ø§ÙÚ©Øªâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ */
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
            100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ù‡Ø¯Ø± -->
        <div class="header">
            <h1><i class="fas fa-robot"></i> Ø³Ø§Ø²Ù†Ø¯Ù‡ Ø¹Ú©Ø³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ</h1>
            <p>Ø¨Ø§ Ù‚Ø¯Ø±Øª Ú†Ù†Ø¯ÛŒÙ† API Ø±Ø§ÛŒÚ¯Ø§Ù† - Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ú©ÛŒÙÛŒØª Ø¯Ø± Ú©Ù…ØªØ± Ø§Ø² Û³Û° Ø«Ø§Ù†ÛŒÙ‡</p>
            <div class="api-badge">
                <i class="fas fa-bolt"></i> Ø¢Ù†Ù„Ø§ÛŒÙ† Ùˆ ÙØ¹Ø§Ù„ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡
            </div>
        </div>
        
        <!-- Ø¯Ú©Ù…Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ -->
        <button class="mobile-menu" id="mobileMenu">
            <i class="fas fa-bars"></i> Ù†Ù…Ø§ÛŒØ´ Ù…Ù†Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
        </button>
        
        <!-- Ù…Ø­ØªÙˆØ§ -->
        <div class="content">
            <!-- Ù¾Ù†Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª -->
            <div class="settings-panel" id="settingsPanel">
                <div class="panel-title">
                    <i class="fas fa-sliders-h"></i> ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¹Ú©Ø³
                </div>
                
                <!-- Ø§Ù†ØªØ®Ø§Ø¨ API -->
                <div class="api-selector">
                    <div class="form-label">
                        <i class="fas fa-server"></i> Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÙˆØªÙˆØ± AI
                    </div>
                    <div class="grid-3">
                        <div class="api-option active" onclick="selectApi('pollinations')">
                            <input type="radio" id="api1" name="api" class="api-radio" checked>
                            <label for="api1" class="api-label">
                                <i class="fas fa-bolt"></i> Pollinations
                            </label>
                            <div class="api-features">Ø³Ø±ÛŒØ¹ â€¢ Ø±Ø§ÛŒÚ¯Ø§Ù† â€¢ Ù…ØªÙ†ÙˆØ¹</div>
                        </div>
                        <div class="api-option" onclick="selectApi('prodia')">
                            <input type="radio" id="api2" name="api" class="api-radio">
                            <label for="api2" class="api-label">
                                <i class="fas fa-star"></i> Prodia
                            </label>
                            <div class="api-features">Ú©ÛŒÙÛŒØª Ø¨Ø§Ù„Ø§ â€¢ Ø±Ø§ÛŒÚ¯Ø§Ù†</div>
                        </div>
                        <div class="api-option" onclick="selectApi('lexica')">
                            <input type="radio" id="api3" name="api" class="api-radio">
                            <label for="api3" class="api-label">
                                <i class="fas fa-search"></i> Lexica
                            </label>
                            <div class="api-features">Ù‡Ù†Ø±ÛŒ â€¢ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø¬Ø³ØªØ¬Ùˆ</div>
                        </div>
                    </div>
                </div>
                
                <!-- Ù…ØªÙ† ØªÙˆØµÛŒÙÛŒ -->
                <div class="form-group">
                    <div class="form-label">
                        <i class="fas fa-pen"></i> Ù…ØªÙ† ØªÙˆØµÛŒÙÛŒ (Prompt)
                        <span class="tooltip">
                            <i class="fas fa-question-circle" style="color: var(--gray); font-size: 0.9rem;"></i>
                            <span class="tooltiptext">Ø¹Ú©Ø³ Ø¯Ù„Ø®ÙˆØ§Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ ØªÙˆØµÛŒÙ Ú©Ù†ÛŒØ¯. Ù‡Ø±Ú†Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ±ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ØŒ Ù†ØªÛŒØ¬Ù‡ Ø¨Ù‡ØªØ±ÛŒ Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒØ¯.</span>
                        </span>
                    </div>
                    <textarea id="prompt" class="prompt-input" placeholder="Ù…Ø«Ø§Ù„: A beautiful mountain landscape at sunset with a lake reflecting the sky, digital art, highly detailed, 4k">A beautiful mountain landscape at sunset with a lake reflecting the sky, digital art, highly detailed, 4k</textarea>
                    <div class="char-count" id="charCount">0 Ú©Ø§Ø±Ø§Ú©ØªØ±</div>
                </div>
                
                <!-- Negative Prompt -->
                <div class="form-group">
                    <div class="form-label">
                        <i class="fas fa-ban"></i> Negative Prompt (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
                    </div>
                    <input type="text" id="negativePrompt" class="negative-input" placeholder="Ù…Ø«Ø§Ù„: blurry, ugly, deformed, text, watermark, low quality">
                </div>
                
                <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯ÛŒÚ¯Ø± -->
                <div class="grid-2">
                    <div class="form-group">
                        <div class="form-label">
                            <i class="fas fa-expand-alt"></i> Ø§Ù†Ø¯Ø§Ø²Ù‡ ØªØµÙˆÛŒØ±
                        </div>
                        <select id="size">
                            <option value="512">512Ã—512 (Ø³Ø±ÛŒØ¹)</option>
                            <option value="768" selected>768Ã—768 (Ù…ØªÙˆØ³Ø·)</option>
                            <option value="1024">1024Ã—1024 (Ú©ÛŒÙÛŒØª Ø®ÙˆØ¨)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <div class="form-label">
                            <i class="fas fa-seedling"></i> Seed (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
                        </div>
                        <input type="number" id="seed" placeholder="Ø®Ø§Ù„ÛŒ = Ø±Ù†Ø¯ÙˆÙ…">
                    </div>
                </div>
                
                <!-- ØªØ¹Ø¯Ø§Ø¯ ØªØµØ§ÙˆÛŒØ± -->
                <div class="form-group">
                    <div class="form-label">
                        <i class="fas fa-copy"></i> ØªØ¹Ø¯Ø§Ø¯ ØªØµØ§ÙˆÛŒØ±
                    </div>
                    <select id="batchCount">
                        <option value="1" selected>1 Ø¹Ú©Ø³</option>
                        <option value="2">2 Ø¹Ú©Ø³</option>
                        <option value="4">4 Ø¹Ú©Ø³</option>
                    </select>
                </div>
                
                <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ -->
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="generateImage()">
                        <i class="fas fa-magic"></i> Ø³Ø§Ø®Øª Ø¹Ú©Ø³
                    </button>
                    <button class="btn btn-secondary" onclick="testAllApis()">
                        <i class="fas fa-vial"></i> ØªØ³Øª Ù‡Ù…Ù‡ APIÙ‡Ø§
                    </button>
                </div>
                
                <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ -->
                <div class="grid-3" style="margin-top: 15px;">
                    <button class="btn" onclick="clearAll()" style="background: #f1f5f9; color: var(--dark);">
                        <i class="fas fa-eraser"></i> Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†
                    </button>
                    <button class="btn" onclick="generateRandomPrompt()" style="background: #fef3c7; color: #92400e;">
                        <i class="fas fa-dice"></i> Ù…ØªÙ† ØªØµØ§Ø¯ÙÛŒ
                    </button>
                    <button class="btn" onclick="showHistory()" style="background: #dbeafe; color: #1e40af;">
                        <i class="fas fa-history"></i> ØªØ§Ø±ÛŒØ®Ú†Ù‡
                    </button>
                </div>
            </div>
            
            <!-- Ù¾Ù†Ù„ Ù†ØªØ§ÛŒØ¬ -->
            <div class="result-panel">
                <div class="result-header">
                    <div class="panel-title">
                        <i class="fas fa-image"></i> Ù†ØªÛŒØ¬Ù‡ ØªÙˆÙ„ÛŒØ¯
                    </div>
                    <div id="apiStatus" style="font-size: 0.9rem; color: var(--success);">
                        <i class="fas fa-circle" style="font-size: 0.7rem;"></i> Ø¢Ù…Ø§Ø¯Ù‡
                    </div>
                </div>
                
                <div class="result-area">
                    <!-- Ø­Ø§Ù„Øª Ø§ÙˆÙ„ÛŒÙ‡ -->
                    <div class="placeholder" id="placeholder">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>ğŸ¨ Ø¹Ú©Ø³ Ø´Ù…Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</h3>
                        <p>ÛŒÚ© Ù…ØªÙ† ØªÙˆØµÛŒÙÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ Ùˆ Ø¯Ú©Ù…Ù‡ "Ø³Ø§Ø®Øª Ø¹Ú©Ø³" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯</p>
                        <p style="color: var(--primary); margin-top: 15px;">
                            <i class="fas fa-lightbulb"></i> Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: Ø§Ø² Ù…ØªÙ† Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ±ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯
                        </p>
                    </div>
                    
                    <!-- Ù„ÙˆØ¯ÛŒÙ†Ú¯ -->
                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <h3 id="loadingText">Ø¯Ø± Ø­Ø§Ù„ Ø³Ø§Ø®Øª Ø¹Ú©Ø³...</h3>
                        <div class="loading-details">
                            <div id="loadingDetail">Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª...</div>
                            <div class="progress-bar">
                                <div class="progress" id="progressBar"></div>
                            </div>
                            <div id="estimatedTime">Ø²Ù…Ø§Ù† ØªÙ‚Ø±ÛŒØ¨ÛŒ: Û±Ûµ-Û³Û° Ø«Ø§Ù†ÛŒÙ‡</div>
                        </div>
                    </div>
                    
                    <!-- ØªØµÙˆÛŒØ± ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ -->
                    <img id="resultImage" class="result-image" alt="ØªØµÙˆÛŒØ± ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡">
                    
                    <!-- ØªØµØ§ÙˆÛŒØ± Batch -->
                    <div id="batchResults" style="display: none; width: 100%;">
                        <div class="grid-2" id="batchGrid" style="gap: 15px; margin-bottom: 20px;"></div>
                    </div>
                </div>
                
                <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ú©Ø´Ù† -->
                <div class="action-buttons" id="actionButtons">
                    <button class="action-btn download-btn" onclick="downloadImage()">
                        <i class="fas fa-download"></i> Ø¯Ø§Ù†Ù„ÙˆØ¯
                    </button>
                    <button class="action-btn regenerate-btn" onclick="generateImage()">
                        <i class="fas fa-redo"></i> Ø³Ø§Ø®Øª Ù…Ø¬Ø¯Ø¯
                    </button>
                    <button class="action-btn share-btn" onclick="shareImage()">
                        <i class="fas fa-share-alt"></i> Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ
                    </button>
                </div>
                
                <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¹Ú©Ø³ -->
                <div class="image-info" id="imageInfo">
                    <div class="info-row">
                        <span class="info-label">Ù…ÙˆØªÙˆØ± AI:</span>
                        <span class="info-value" id="infoEngine">Pollinations.ai</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Ø§Ù†Ø¯Ø§Ø²Ù‡:</span>
                        <span class="info-value" id="infoSize">768Ã—768</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ØªØ§Ø±ÛŒØ® ØªÙˆÙ„ÛŒØ¯:</span>
                        <span class="info-value" id="infoDate">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Seed:</span>
                        <span class="info-value" id="infoSeed">123456</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ -->
        <div class="examples">
            <div class="examples-title">
                <i class="fas fa-lightbulb"></i> Ø§ÛŒØ¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ (Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯)
            </div>
            <div class="example-tags">
                <div class="example-tag" onclick="loadExample(1)">
                    <i class="fas fa-mountain"></i> Ù…Ù†Ø¸Ø±Ù‡ Ú©ÙˆÙ‡Ø³ØªØ§Ù† Ø¨Ø±ÙÛŒ
                </div>
                <div class="example-tag" onclick="loadExample(2)">
                    <i class="fas fa-robot"></i> Ø±Ø¨Ø§Øª Ø¯Ø± Ø´Ù‡Ø± Ø¢ÛŒÙ†Ø¯Ù‡
                </div>
                <div class="example-tag" onclick="loadExample(3)">
                    <i class="fas fa-dragon"></i> Ø§Ú˜Ø¯Ù‡Ø§ÛŒ Ø§ÙØ³Ø§Ù†Ù‡â€ŒØ§ÛŒ
                </div>
                <div class="example-tag" onclick="loadExample(4)">
                    <i class="fas fa-cat"></i> Ú¯Ø±Ø¨Ù‡ Ø³Ø­Ø±Ø¢Ù…ÛŒØ² Ø¯Ø± Ø¬Ù†Ú¯Ù„
                </div>
                <div class="example-tag" onclick="loadExample(5)">
                    <i class="fas fa-umbrella-beach"></i> Ø³Ø§Ø­Ù„ Ø§Ø³ØªÙˆØ§ÛŒÛŒ Ø¯Ø± ØºØ±ÙˆØ¨
                </div>
                <div class="example-tag" onclick="loadExample(6)">
                    <i class="fas fa-city"></i> Ø´Ù‡Ø± Ø³Ø§ÛŒØ¨Ø±Ù¾Ø§Ù†Ú© Ø´Ø¨Ø§Ù†Ù‡
                </div>
            </div>
        </div>
        
        <!-- ØªØ§Ø±ÛŒØ®Ú†Ù‡ -->
        <div class="history-section" id="historySection" style="display: none;">
            <div class="history-title">
                <i class="fas fa-history"></i> ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡
            </div>
            <div class="history-grid" id="historyGrid">
                <div class="empty-history">Ù‡Ù†ÙˆØ² Ø¹Ú©Ø³ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯</div>
            </div>
        </div>
        
        <!-- ÙÙˆØªØ± -->
        <div class="footer">
            <p>Ø¨Ø§ Ù‚Ø¯Ø±Øª Ú†Ù†Ø¯ÛŒÙ† API Ø±Ø§ÛŒÚ¯Ø§Ù† Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ â€¢ Ú©Ø§Ù…Ù„Ø§Ù‹ Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ù…Ø±ÙˆØ±Ú¯Ø±</p>
            <p><i class="fas fa-clock"></i> ØªÙˆÙ„ÛŒØ¯ Ø¹Ú©Ø³ Û±Û°-Û´Û° Ø«Ø§Ù†ÛŒÙ‡ Ø²Ù…Ø§Ù† Ù…ÛŒâ€ŒØ¨Ø±Ø¯</p>
            <div class="footer-links">
                <a href="#" class="footer-link" onclick="showInstructions()"><i class="fas fa-question-circle"></i> Ø±Ø§Ù‡Ù†Ù…Ø§</a>
                <a href="#" class="footer-link" onclick="showAbout()"><i class="fas fa-info-circle"></i> Ø¯Ø±Ø¨Ø§Ø±Ù‡</a>
                <a href="#" class="footer-link" onclick="toggleDarkMode()"><i class="fas fa-moon"></i> Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©</a>
            </div>
        </div>
    </div>
    
    <!-- Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† -->
    <div class="notification" id="notification">
        <button class="notification-close" onclick="closeNotification()">Ã—</button>
        <div id="notificationMessage"></div>
    </div>

    <script>
        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡
        let currentApi = 'pollinations';
        let generatedImages = [];
        let imageHistory = [];
        let isGenerating = false;
        
        // Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡
        const examples = [
            "A majestic snow-covered mountain range at sunrise, with a clear blue lake in the foreground, digital painting, highly detailed, 8k resolution, artstation trending",
            "A futuristic robot walking through a neon-lit cyberpunk city at night, rain reflecting on the streets, cinematic lighting, detailed, 4k",
            "A mythical dragon with iridescent scales flying over a medieval castle at dusk, fantasy art, dramatic lighting, epic composition, trending on artstation",
            "A magical cat with glowing eyes sitting in an enchanted forest, surrounded by bioluminescent plants, fantasy art, detailed, whimsical style",
            "A tropical beach with crystal clear turquoise water and white sand at sunset, palm trees, vibrant colors, photorealistic, 8k",
            "A cyberpunk cityscape at night with towering skyscrapers, flying cars, neon signs in Japanese, rain, blade runner style, cinematic"
        ];
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø«Ø§Ù„
        function loadExample(index) {
            if (index >= 1 && index <= examples.length) {
                document.getElementById('prompt').value = examples[index - 1];
                updateCharCount();
                showNotification(`âœ… Ù…Ø«Ø§Ù„ ${index} Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯!`, 'success');
            }
        }
        
        // Ø§Ù†ØªØ®Ø§Ø¨ API
        function selectApi(api) {
            currentApi = api;
            
            // Ø­Ø°Ù active Ø§Ø² Ù‡Ù…Ù‡
            document.querySelectorAll('.api-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† API Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
            event.currentTarget.classList.add('active');
            
            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª
            document.getElementById('apiStatus').innerHTML = 
                `<i class="fas fa-circle" style="font-size: 0.7rem; color: var(--success);"></i> ${getApiName(api)} Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯`;
            
            showNotification(`âœ… Ù…ÙˆØªÙˆØ± AI Ø¨Ù‡ ${getApiName(api)} ØªØºÛŒÛŒØ± Ú©Ø±Ø¯`, 'success');
        }
        
        // Ù†Ø§Ù… API
        function getApiName(api) {
            const names = {
                'pollinations': 'Pollinations.ai',
                'prodia': 'Prodia',
                'lexica': 'Lexica'
            };
            return names[api] || 'Unknown';
        }
        
        // ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ ØªÙˆÙ„ÛŒØ¯ ØªØµÙˆÛŒØ±
        async function generateImage() {
            if (isGenerating) {
                showNotification("âš ï¸ Ù„Ø·ÙØ§Ù‹ ØµØ¨Ø± Ú©Ù†ÛŒØ¯... Ø¯Ø± Ø­Ø§Ù„ Ø³Ø§Ø®Øª Ø¹Ú©Ø³ Ù‚Ø¨Ù„ÛŒ", 'warning');
                return;
            }
            
            let prompt = document.getElementById('prompt').value.trim();
            
            if (!prompt) {
                showNotification("âš ï¸ Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ù…ØªÙ† ØªÙˆØµÛŒÙÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!", 'error');
                return;
            }
            
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø­Ø§Ù„Øª Ø³Ø§Ø®Øª
            isGenerating = true;
            
            // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† placeholder Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù„ÙˆØ¯ÛŒÙ†Ú¯
            document.getElementById('placeholder').style.display = 'none';
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultImage').style.display = 'none';
            document.getElementById('actionButtons').style.display = 'none';
            document.getElementById('imageInfo').style.display = 'none';
            document.getElementById('batchResults').style.display = 'none';
            
            // Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
            const size = document.getElementById('size').value;
            const negative = document.getElementById('negativePrompt').value.trim();
            const seed = document.getElementById('seed').value || Math.floor(Math.random() * 1000000);
            const batchCount = parseInt(document.getElementById('batchCount').value);
            
            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ØªÙ† Ù„ÙˆØ¯ÛŒÙ†Ú¯
            document.getElementById('loadingText').textContent = `Ø¯Ø± Ø­Ø§Ù„ Ø³Ø§Ø®Øª Ø¹Ú©Ø³ Ø¨Ø§ ${getApiName(currentApi)}...`;
            document.getElementById('loadingDetail').textContent = "Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø³Ø±ÙˆØ±...";
            
            // Ø´Ø±ÙˆØ¹ Ù¾ÛŒØ´Ø±ÙØª
            updateProgress(10);
            
            try {
                let imageUrls = [];
                
                if (batchCount > 1) {
                    // Ø³Ø§Ø®Øª Ú†Ù†Ø¯ Ø¹Ú©Ø³
                    document.getElementById('loadingDetail').textContent = `Ø³Ø§Ø®Øª ${batchCount} Ø¹Ú©Ø³...`;
                    
                    for (let i = 0; i < batchCount; i++) {
                        const currentSeed = seed + i;
                        updateProgress(10 + (i * (80 / batchCount)));
                        
                        const imageUrl = await generateWithApi(prompt, size, negative, currentSeed);
                        if (imageUrl) {
                            imageUrls.push(imageUrl);
                        }
                        
                        document.getElementById('loadingDetail').textContent = `Ø³Ø§Ø®Øª Ø¹Ú©Ø³ ${i + 1} Ø§Ø² ${batchCount}...`;
                    }
                    
                    // Ù†Ù…Ø§ÛŒØ´ Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ batch
                    if (imageUrls.length > 0) {
                        displayBatchImages(imageUrls, prompt, size, seed);
                    }
                } else {
                    // Ø³Ø§Ø®Øª ÛŒÚ© Ø¹Ú©Ø³
                    updateProgress(30);
                    document.getElementById('loadingDetail').textContent = "Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´ ØªÙˆØ³Ø· Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ...";
                    
                    const imageUrl = await generateWithApi(prompt, size, negative, seed);
                    
                    if (imageUrl) {
                        updateProgress(80);
                        document.getElementById('loadingDetail').textContent = "Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØµÙˆÛŒØ±...";
                        
                        // Ù†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ±
                        displaySingleImage(imageUrl, prompt, size, seed);
                    }
                }
                
                updateProgress(100);
                
            } catch (error) {
                console.error("Error generating image:", error);
                showNotification("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø³Ø§Ø®Øª Ø¹Ú©Ø³. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.", 'error');
                document.getElementById('loading').innerHTML = `
                    <div style="color: var(--danger); text-align: center;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <h3>Ø®Ø·Ø§ Ø¯Ø± Ø³Ø§Ø®Øª Ø¹Ú©Ø³</h3>
                        <p>${error.message || 'Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ± Ù¾ÛŒØ´ Ø¢Ù…Ø¯'}</p>
                        <button class="btn" onclick="generateImage()" style="background: var(--primary); color: white; margin-top: 20px;">
                            <i class="fas fa-redo"></i> ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯
                        </button>
                    </div>
                `;
            } finally {
                isGenerating = false;
            }
        }
        
        // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ API Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
        async function generateWithApi(prompt, size, negative, seed) {
            let url = '';
            
            switch(currentApi) {
                case 'pollinations':
                    url = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}`;
                    url += `?width=${size}&height=${size}`;
                    url += `&seed=${seed}`;
                    if (negative) url += `&negative=${encodeURIComponent(negative)}`;
                    url += `&model=flux&nologo=true&_=${Date.now()}`;
                    break;
                    
                case 'prodia':
                    // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² proxy Ø¨Ø±Ø§ÛŒ Ø¯ÙˆØ± Ø²Ø¯Ù† CORS
                    url = `https://images.prodia.xyz/generate?prompt=${encodeURIComponent(prompt)}`;
                    url += `&width=${size}&height=${size}`;
                    url += `&seed=${seed}`;
                    if (negative) url += `&negative_prompt=${encodeURIComponent(negative)}`;
                    url += `&steps=25&cfg_scale=7.5&_=${Date.now()}`;
                    break;
                    
                case 'lexica':
                    url = `https://lexica.art/api/v1/search?q=${encodeURIComponent(prompt)}`;
                    try {
                        const response = await fetch(url);
                        const data = await response.json();
                        if (data.images && data.images.length > 0) {
                            return data.images[0].src;
                        }
                        throw new Error('No image found');
                    } catch (error) {
                        // Fallback Ø¨Ù‡ Pollinations
                        currentApi = 'pollinations';
                        return generateWithApi(prompt, size, negative, seed);
                    }
                    break;
            }
            
            return url;
        }
        
        // Ù†Ù…Ø§ÛŒØ´ ØªÚ© Ø¹Ú©Ø³
        function displaySingleImage(imageUrl, prompt, size, seed) {
            const img = new Image();
            const startTime = Date.now();
            
            img.onload = function() {
                const endTime = Date.now();
                const duration = (endTime - startTime) / 1000;
                
                // Ù†Ù…Ø§ÛŒØ´ ØªØµÙˆÛŒØ±
                document.getElementById('resultImage').src = imageUrl;
                document.getElementById('resultImage').style.display = 'block';
                document.getElementById('loading').style.display = 'none';
                document.getElementById('actionButtons').style.display = 'flex';
                document.getElementById('imageInfo').style.display = 'block';
                
                // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                document.getElementById('infoEngine').textContent = getApiName(currentApi);
                document.getElementById('infoSize').textContent = `${size}Ã—${size}`;
                document.getElementById('infoDate').textContent = new Date().toLocaleString('fa-IR');
                document.getElementById('infoSeed').textContent = seed;
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± ØªØ§Ø±ÛŒØ®Ú†Ù‡
                saveToHistory(imageUrl, prompt, size, seed);
                
                showNotification(`âœ… Ø¹Ú©Ø³ Ø¯Ø± ${duration.toFixed(1)} Ø«Ø§Ù†ÛŒÙ‡ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯!`, 'success');
            };
            
            img.onerror = function() {
                // ØªÙ„Ø§Ø´ Ø¨Ø§ API Ø¯ÛŒÚ¯Ø±
                showNotification("âš ï¸ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù…ØªØ­Ø§Ù† API Ø¯ÛŒÚ¯Ø±...", 'warning');
                currentApi = currentApi === 'pollinations' ? 'prodia' : 'pollinations';
                generateImage();
            };
            
            img.src = imageUrl;
            generatedImages.push(imageUrl);
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ø¹Ú©Ø³â€ŒÙ‡Ø§ÛŒ batch
        function displayBatchImages(imageUrls, prompt, size, seed) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('batchResults').style.display = 'block';
            
            const batchGrid = document.getElementById('batchGrid');
            batchGrid.innerHTML = '';
            
            imageUrls.forEach((url, index) => {
                const imgContainer = document.createElement('div');
                imgContainer.style.position = 'relative';
                imgContainer.innerHTML = `
                    <img src="${url}" style="width: 100%; border-radius: 10px; margin-bottom: 10px;">
                    <button onclick="downloadSingleImage('${url}')" style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer;">
                        <i class="fas fa-download"></i>
                    </button>
                    <div style="text-align: center; font-size: 0.9rem; color: var(--gray);">Ø¹Ú©Ø³ ${index + 1}</div>
                `;
                batchGrid.appendChild(imgContainer);
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± ØªØ§Ø±ÛŒØ®Ú†Ù‡
                saveToHistory(url, prompt, size, seed + index);
            });
            
            document.getElementById('actionButtons').style.display = 'flex';
            document.getElementById('imageInfo').style.display = 'block';
            document.getElementById('infoEngine').textContent = getApiName(currentApi);
            document.getElementById('infoSize').textContent = `${size}Ã—${size} (${imageUrls.length} ØªØµÙˆÛŒØ±)`;
            document.getElementById('infoDate').textContent = new Date().toLocaleString('fa-IR');
            document.getElementById('infoSeed').textContent = seed;
            
            showNotification(`âœ… ${imageUrls.length} Ø¹Ú©Ø³ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯!`, 'success');
        }
        
        // Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¹Ú©Ø³
        function downloadImage() {
            const img = document.getElementById('resultImage');
            if (!img || !img.src || img.src.includes('placeholder')) {
                showNotification("âš ï¸ Ø§Ø¨ØªØ¯Ø§ Ø¹Ú©Ø³ÛŒ Ø¨Ø³Ø§Ø²ÛŒØ¯!", 'warning');
                return;
            }
            
            try {
                const link = document.createElement('a');
                link.href = img.src;
                link.download = `ai-image-${Date.now()}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showNotification("âœ… Ø¹Ú©Ø³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯!", 'success');
            } catch (error) {
                showNotification("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¹Ú©Ø³", 'error');
            }
        }
        
        // Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¹Ú©Ø³ ØªÚ©ÛŒ Ø§Ø² batch
        function downloadSingleImage(url) {
            try {
                const link = document.createElement('a');
                link.href = url;
                link.download = `ai-image-${Date.now()}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showNotification("âœ… Ø¹Ú©Ø³ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯!", 'success');
            } catch (error) {
                showNotification("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¹Ú©Ø³", 'error');
            }
        }
        
        // ØªØ³Øª Ù‡Ù…Ù‡ APIÙ‡Ø§
        async function testAllApis() {
            showNotification("ğŸ§ª Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ù‡Ù…Ù‡ APIÙ‡Ø§...", 'warning');
            
            const testPrompt = "A beautiful sunset over ocean, digital art";
            const originalApi = currentApi;
            const originalPrompt = document.getElementById('prompt').value;
            
            document.getElementById('prompt').value = testPrompt;
            
            // ØªØ³Øª Pollinations
            currentApi = 'pollinations';
            selectApi('pollinations');
            await new Promise(resolve => setTimeout(resolve, 1000));
            await generateImage();
            
            await new Promise(resolve => setTimeout(resolve, 3000));
            
            // ØªØ³Øª Prodia
            currentApi = 'prodia';
            selectApi('prodia');
            await new Promise(resolve => setTimeout(resolve, 1000));
            await generateImage();
            
            // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† ØªÙ†Ø¸ÛŒÙ…Ø§Øª
            document.getElementById('prompt').value = originalPrompt;
            currentApi = originalApi;
            selectApi(originalApi);
        }
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± ØªØ§Ø±ÛŒØ®Ú†Ù‡
        function saveToHistory(imageUrl, prompt, size, seed) {
            const historyItem = {
                url: imageUrl,
                prompt: prompt.substring(0, 50) + (prompt.length > 50 ? '...' : ''),
                size: size,
                seed: seed,
                date: new Date().toLocaleString('fa-IR'),
                api: currentApi
            };
            
            imageHistory.unshift(historyItem);
            
            // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¨Ù‡ 20 Ø¢ÛŒØªÙ…
            if (imageHistory.length > 20) {
                imageHistory.pop();
            }
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
            localStorage.setItem('aiImageHistory', JSON.stringify(imageHistory));
            
            // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ®Ú†Ù‡
            updateHistoryDisplay();
        }
        
        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ®Ú†Ù‡
        function updateHistoryDisplay() {
            const historyGrid = document.getElementById('historyGrid');
            
            if (imageHistory.length === 0) {
                historyGrid.innerHTML = '<div class="empty-history">Ù‡Ù†ÙˆØ² Ø¹Ú©Ø³ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯</div>';
                return;
            }
            
            historyGrid.innerHTML = '';
            
            imageHistory.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `<img src="${item.url}" alt="${item.prompt}">`;
                historyItem.onclick = () => {
                    // Ø­Ø°Ù active Ø§Ø² Ù‡Ù…Ù‡
                    document.querySelectorAll('.history-item').forEach(el => {
                        el.classList.remove('active');
                    });
                    
                    // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ† Ø¢ÛŒØªÙ…
                    historyItem.classList.add('active');
                    
                    // Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                    document.getElementById('resultImage').src = item.url;
                    document.getElementById('resultImage').style.display = 'block';
                    document.getElementById('placeholder').style.display = 'none';
                    document.getElementById('actionButtons').style.display = 'flex';
                    
                    showNotification(`ğŸ“‚ Ù†Ù…Ø§ÛŒØ´ Ø¹Ú©Ø³ Ø§Ø² ØªØ§Ø±ÛŒØ®Ú†Ù‡`, 'success');
                };
                
                historyGrid.appendChild(historyItem);
            });
        }
        
        // Ù†Ù…Ø§ÛŒØ´/Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ®Ú†Ù‡
        function showHistory() {
            const historySection = document.getElementById('historySection');
            if (historySection.style.display === 'none') {
                historySection.style.display = 'block';
                updateHistoryDisplay();
            } else {
                historySection.style.display = 'none';
            }
        }
        
        // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡
        function clearAll() {
            document.getElementById('prompt').value = '';
            document.getElementById('negativePrompt').value = '';
            document.getElementById('seed').value = '';
            updateCharCount();
            showNotification("ğŸ§¹ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯", 'success');
        }
        
        // ØªÙˆÙ„ÛŒØ¯ Ù…ØªÙ† ØªØµØ§Ø¯ÙÛŒ
        function generateRandomPrompt() {
            const subjects = ["a dragon", "a futuristic city", "a magical forest", "an alien planet", "a cyberpunk street", "a medieval castle", "a space station", "a underwater city", "a steampunk machine", "a fantasy creature"];
            const styles = ["digital art", "oil painting", "watercolor", "photorealistic", "anime style", "concept art", "impressionist", "surrealism", "minimalist", "hyperdetailed"];
            const qualities = ["8k resolution", "highly detailed", "trending on artstation", "cinematic lighting", "dynamic composition", "beautiful colors", "epic scale", "masterpiece", "award winning"];
            
            const randomSubject = subjects[Math.floor(Math.random() * subjects.length)];
            const randomStyle = styles[Math.floor(Math.random() * styles.length)];
            const randomQuality = qualities[Math.floor(Math.random() * qualities.length)];
            
            const prompt = `${randomSubject}, ${randomStyle}, ${randomQuality}`;
            document.getElementById('prompt').value = prompt;
            updateCharCount();
            showNotification("ğŸ² Ù…ØªÙ† ØªØµØ§Ø¯ÙÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯!", 'success');
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª
        function updateProgress(percent) {
            document.getElementById('progressBar').style.width = percent + '%';
        }
        
        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ù…Ø§Ø±Ø´ Ú©Ø§Ø±Ø§Ú©ØªØ±
        function updateCharCount() {
            const prompt = document.getElementById('prompt').value;
            document.getElementById('charCount').textContent = `${prompt.length} Ú©Ø§Ø±Ø§Ú©ØªØ±`;
        }
        
        // Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ
        function shareImage() {
            const img = document.getElementById('resultImage');
            if (!img || !img.src) {
                showNotification("âš ï¸ Ø§Ø¨ØªØ¯Ø§ Ø¹Ú©Ø³ÛŒ Ø¨Ø³Ø§Ø²ÛŒØ¯!", 'warning');
                return;
            }
            
            if (navigator.share) {
                navigator.share({
                    title: 'Ø¹Ú©Ø³ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ',
                    text: 'Ù…Ù† Ø§ÛŒÙ† Ø¹Ú©Ø³ Ø±Ø§ Ø¨Ø§ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ø¹Ú©Ø³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø³Ø§Ø®ØªÙ‡â€ŒØ§Ù…!',
                    url: img.src
                });
            } else {
                // Ú©Ù¾ÛŒ Ù„ÛŒÙ†Ú©
                navigator.clipboard.writeText(img.src).then(() => {
                    showNotification("ğŸ”— Ù„ÛŒÙ†Ú© Ø¹Ú©Ø³ Ø¯Ø± Ú©Ù„ÛŒÙ¾â€ŒØ¨ÙˆØ±Ø¯ Ú©Ù¾ÛŒ Ø´Ø¯!", 'success');
                });
            }
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
        function showNotification(message, type = 'info') {
            const notif = document.getElementById('notification');
            const messageEl = document.getElementById('notificationMessage');
            
            messageEl.textContent = message;
            notif.className = `notification ${type}`;
            notif.style.display = 'block';
            
            // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø®ÙˆØ¯Ú©Ø§Ø±
            setTimeout(() => {
                if (notif.style.display === 'block') {
                    notif.style.display = 'none';
                }
            }, 5000);
        }
        
        // Ø¨Ø³ØªÙ† Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
        function closeNotification() {
            document.getElementById('notification').style.display = 'none';
        }
        
        // Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡
        function showInstructions() {
            showNotification("ğŸ“– Ø±Ø§Ù‡Ù†Ù…Ø§: Ù…ØªÙ† Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ØŒ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ Ùˆ Ø¯Ú©Ù…Ù‡ Ø³Ø§Ø®Øª Ø¹Ú©Ø³ Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯. Ø¨Ø±Ø§ÛŒ Ù†ØªØ§ÛŒØ¬ Ø¨Ù‡ØªØ±ØŒ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ±ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯.", 'info');
        }
        
        // Ø¯Ø±Ø¨Ø§Ø±Ù‡
        function showAbout() {
            showNotification("ğŸ¨ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ø¹Ú©Ø³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡. Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø² APIÙ‡Ø§ÛŒ Ø±Ø§ÛŒÚ¯Ø§Ù† Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¹Ú©Ø³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø¨Ø§ HTMLØŒ CSS Ùˆ JavaScript.", 'info');
        }
        
        // ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDark);
            showNotification(isDark ? "ğŸŒ™ Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© ÙØ¹Ø§Ù„ Ø´Ø¯" : "â˜€ï¸ Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù† ÙØ¹Ø§Ù„ Ø´Ø¯", 'success');
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø§Ø² localStorage
        function loadHistory() {
            const savedHistory = localStorage.getItem('aiImageHistory');
            if (savedHistory) {
                try {
                    imageHistory = JSON.parse(savedHistory);
                } catch (e) {
                    imageHistory = [];
                }
            }
        }
        
        // Ù…Ù†ÙˆÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
        document.getElementById('mobileMenu').addEventListener('click', function() {
            const settingsPanel = document.getElementById('settingsPanel');
            settingsPanel.classList.toggle('active');
            this.innerHTML = settingsPanel.classList.contains('active') 
                ? '<i class="fas fa-times"></i> Ø¨Ø³ØªÙ† Ù…Ù†Ùˆ' 
                : '<i class="fas fa-bars"></i> Ù†Ù…Ø§ÛŒØ´ Ù…Ù†Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª';
        });
        
        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        window.onload = function() {
            // ØªÙ†Ø¸ÛŒÙ… seed ØªØµØ§Ø¯ÙÛŒ
            document.getElementById('seed').value = Math.floor(Math.random() * 1000000);
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ§Ø±ÛŒØ®Ú†Ù‡
            loadHistory();
            
            // ØªÙ†Ø¸ÛŒÙ… Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø´Ù…Ø§Ø±Ø´ Ú©Ø§Ø±Ø§Ú©ØªØ±
            document.getElementById('prompt').addEventListener('input', updateCharCount);
            updateCharCount();
            
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Enter Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„
            document.getElementById('prompt').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    generateImage();
                }
            });
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ©
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
            }
            
            // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯
            setTimeout(() => {
                showNotification("ğŸ¨ Ø³Ø§Ø²Ù†Ø¯Ù‡ Ø¹Ú©Ø³ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª! Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ ÛŒÚ© Ù…ØªÙ† Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ ÛŒØ§ Ø§Ø² Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.", 'success');
            }, 1000);
        };
    </script>
</body>
</html>